
<app-server-list [input]="id" [input2]="chat"></app-server-list>

<app-friend-list></app-friend-list>

<div class="home">

    <div class="upper-chat">
        <p class="inner-upper-chat"><span class="tag">@</span>{{friend.username}}</p>
    </div>

    <div class="xat" #target>
        <br>
        <div *ngIf=" chat.users_array[0] == token._id && chat.users_array[1] == id">
            <div *ngFor="let message of chat.messages">
                <div class="sent-message" *ngIf="message[0] == token._id">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chat-right-text sent-icon" viewBox="0 0 16 16">
                        <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1H2zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z"/>
                        <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                    </svg>
                    <div *ngIf="message[3] == true">
                        <a class="sent-inner-message" href="{{message[1]}}" target="_blank">{{message[1]}}</a>
                        <p class="sent-inner-message">{{message[2]}}</p>
                    </div>
                    <div *ngIf="message[3] == false">
                        <p class="sent-inner-message">{{message[1]}}</p>
                        <p class="sent-inner-message">{{message[2]}}</p>
                    </div>
                </div><br>  
                <div class="recieved-message" *ngIf="message[0] == id">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chat-left-text recieved-icon" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                        <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                    </svg>
                    <div *ngIf="message[3] == true">
                        <a class="recieved-inner-message" href="{{message[1]}}" target="_blank">{{message[1]}}</a>
                        <p class="inner-message">{{message[2]}}</p>
                    </div>
                    <div *ngIf="message[3] == false">
                        <p class="recieved-inner-message">{{message[1]}}</p>
                        <p class="recieved-inner-message">{{message[2]}}</p>
                    </div>
                </div><br>  
            </div>
        </div>

        <div *ngIf=" chat.users_array[1] == token._id && chat.users_array[0] == id">
            <div *ngFor="let message of chat.messages">
                <div class="sent-message" *ngIf="message[0] == token._id">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chat-right-text sent-icon" viewBox="0 0 16 16">
                        <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1H2zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z"/>
                        <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                    </svg>
                    <div *ngIf="message[3] == true">
                        <a class="sent-inner-message" href="{{message[1]}}" target="_blank">{{message[1]}}</a>
                        <p class="sent-inner-message">{{message[2]}}</p>
                    </div>
                    <div *ngIf="message[3] == false">
                        <p class="sent-inner-message">{{message[1]}}</p>
                        <p class="sent-inner-message">{{message[2]}}</p>
                    </div>
                </div><br>
                <div class="recieved-message" *ngIf="message[0] == id">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chat-left-text recieved-icon" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                        <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                    </svg>
                    <div *ngIf="message[3] == true">
                        <a class="recieved-inner-message" href="{{message[1]}}" target="_blank">{{message[1]}}</a>
                        <p class="recieved-inner-message">{{message[2]}}</p>
                    </div>
                    <div *ngIf="message[3] == false">
                        <p class="recieved-inner-message">{{message[1]}}</p>
                        <p class="recieved-inner-message">{{message[2]}}</p>
                    </div>
                </div><br>
            </div>
        </div>
        <div class="message-box">
            <form #form_post="ngForm" method="POST" (submit)="onSubmit()" (submit)="scrollToElement(target)" (click)="scrollToElement(target)">
                <input class="message" autocomplete="off" type="text" name="message" #message="ngModel" [(ngModel)]="user.message" placeholder="Send message to {{friend.username}}" required>
            </form>
        </div>
    </div>
</div>